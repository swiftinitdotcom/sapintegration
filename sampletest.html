<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Graph API User in SAP</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h2>Microsoft Graph API User Profile</h2>
  <table id="userTable">
    <thead>
      <tr>
        <th>Field</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody id="userData"></tbody>
  </table>
  <script>
    // Paste Postman token (for testing only; insecure for production)
    const accessToken = 'eyJ0eXAiOiJKV1QiLCJub25jZSI6Im9kLVB4eTFLYVRLX3pTcUM5ZndvX3RXOWNNTUZhb3dsa2Z1a1dFczY5TTgiLCJhbGciOiJSUzI1NiIsIng1dCI6InlFVXdtWFdMMTA3Q2MtN1FaMldTYmVPYjNzUSIsImtpZCI6InlFVXdtWFdMMTA3Q2MtN1FaMldTYmVPYjNzUSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC80N2VmOGM4MS05NDI2LTQ4OWItYjU5NC0yOWQ3NzlkNzQ4MjkvIiwiaWF0IjoxNzYxMDU0OTY4LCJuYmYiOjE3NjEwNTQ5NjgsImV4cCI6MTc2MTA1OTc1NywiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsicDEiXSwiYWlvIjoiQVpRQWEvOGFBQUFBcG4yV2h1RE5ocU9OdVpUQ3kxZTdhenVhRTJDQWtIc1NJZmNLa095U3FmckNOL0g5dHIyUTN5UERuekt3VGhPRldDSWVCOW1iWmRDL2JlazlhekNWN045QzhOU3kxZEFHbVJMZFZlVldkTU9YUmdsWlcrbFk5cnk1UXpYblQ1VDN6Z0w3NEFVWjBHdkZjdlhnWi9QdHJCNWR0d3Qvbjdrd1VIcDFhWWdNQjBodFhwZVB3VVB5UWFPSTN2NlBEdWhQIiwiYW1yIjpbInB3ZCIsIm1mYSJdLCJhcHBfZGlzcGxheW5hbWUiOiJTQVAgR3JhcGggQVBJIFRlc3QgQXBwIiwiYXBwaWQiOiIzMWE4OWM2YS1iYWM3LTQ2ZWEtYjRjYy1kZGY1ZWY5NjY5ZjIiLCJhcHBpZGFjciI6IjEiLCJmYW1pbHlfbmFtZSI6ImxvaCIsImdpdmVuX25hbWUiOiJhbWl0IiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiMTA5LjkzLjE1LjI0MSIsIm5hbWUiOiJhbWl0IGxvaCIsIm9pZCI6IjM5ODljNzE2LTU4NGYtNDRlYS1iODgzLTAwNTcyZmNkMmRjZSIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzMjAwMDVDRkE5Q0YyIiwicmgiOiIxLkFUNEFnWXp2UnlhVW0waTFsQ25YZWRkSUtRTUFBQUFBQUFBQXdBQUFBQUFBQUFESEFMMC1BQS4iLCJzY3AiOiJVc2VyLlJlYWQgVXNlci5SZWFkLkFsbCBwcm9maWxlIG9wZW5pZCBlbWFpbCIsInNpZCI6IjAwOWJkMmI5LTU2MDctZmNhNi04NzI3LWViYzJiNTJkNDNkMyIsInN1YiI6Imw4TkY1d00yWXFfQXhnOU5adm9uRXY2V2xkNEpvMjlfWjRsUThjSE5WRkUiLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiQVMiLCJ0aWQiOiI0N2VmOGM4MS05NDI2LTQ4OWItYjU5NC0yOWQ3NzlkNzQ4MjkiLCJ1bmlxdWVfbmFtZSI6InN3aWZ0aW5pdGRvdGNvbUBzd2lmdGluaXQub25taWNyb3NvZnQuY29tIiwidXBuIjoic3dpZnRpbml0ZG90Y29tQHN3aWZ0aW5pdC5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiJCbllfWGZub29VV3BZeDJ3RVJ4OEFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyI2MmU5MDM5NC02OWY1LTQyMzctOTE5MC0wMTIxNzcxNDVlMTAiLCJiNzlmYmY0ZC0zZWY5LTQ2ODktODE0My03NmIxOTRlODU1MDkiXSwieG1zX2FjZCI6MTc2MTAzMjQ0MiwieG1zX2FjdF9mY3QiOiIzIDkiLCJ4bXNfZnRkIjoiNE5CQUFPRXZOMU5FRi1CWmdQR2lsb3JKWXREbFFyamd2amxaSExSVmptMEJhMjl5WldGalpXNTBjbUZzTFdSemJYTSIsInhtc19pZHJlbCI6IjEgMTgiLCJ4bXNfc3QiOnsic3ViIjoiZkF0Q0JBY1VTMzVrSlZVNE5tclRSR2h0WGI0cktQT1ZuanVFZjhTc2l4ayJ9LCJ4bXNfc3ViX2ZjdCI6IjMgNCIsInhtc190Y2R0IjoxNTY2NTcwMzQ2LCJ4bXNfdG50X2ZjdCI6IjMgMTYifQ.KVpE-s27gqZ_FuB65dbBqUm0gJwWYi1ZV5EGVYs_Az4MxbDne1IXCakqgbWOeU9uRYtbPmuw5t4FMD3gp7tRXoH8JOr5B2MRsgdE47nNX4xcm2f0RETAcZU0x5ADX2V94dSh8R-LrsciANaYzB4OSwG1XkasM_zIlSQxhdsA99OMUWF0WyPDYG1-lVUB-XTmpyrpW6h-c5ix_GQi6Xxp_Z65rggMejxPonvNTGj-IhuH0OXWXj04VoV4_2hoRnrtVe2X3yNSX1Bq7Nas9gyRcXpeM9bJQuFAIcgKaLT7NqOdpWvhenUnrb0keO2lmcc5VLDeNM9RuLUtXuc5RUgjmg';
    fetch('https://graph.microsoft.com/v1.0/me', {
      headers: { 'Authorization': `Bearer ${accessToken}` }
    })
      .then(response => response.json())
      .then(data => {
        const tbody = document.getElementById('userData');
        const fields = [
          { key: 'id', label: 'ID' },
          { key: 'displayName', label: 'Display Name' },
          { key: 'givenName', label: 'Given Name' },
          { key: 'surname', label: 'Surname' },
          { key: 'mail', label: 'Email' },
          { key: 'businessPhones', label: 'Business Phone', format: phones => phones.join(', ') },
          { key: 'mobilePhone', label: 'Mobile Phone' },
          { key: 'jobTitle', label: 'Job Title' },
          { key: 'officeLocation', label: 'Office Location' },
          { key: 'preferredLanguage', label: 'Preferred Language' },
          { key: 'userPrincipalName', label: 'User Principal Name' }
        ];
        fields.forEach(field => {
          const value = field.format ? field.format(data[field.key]) : data[field.key] || 'N/A';
          const row = document.createElement('tr');
          row.innerHTML = `<td>${field.label}</td><td>${value}</td>`;
          tbody.appendChild(row);
        });
      })
      .catch(error => {
        document.getElementById('userData').innerHTML = `<tr><td colspan="2">Error: ${error.message}</td></tr>`;
      });
  </script>
</body>
</html>
